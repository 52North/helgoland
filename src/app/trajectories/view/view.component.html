<n52-permalink-button *ngIf="datasetIds.length > 0" [generatedUrlFunction]="permalinkSrvc.createPermalink"></n52-permalink-button>
<div class="combi-mobile" *ngIf="datasetIds.length > 0">
  <div class="combi-header" *ngIf="trajectory?.label">
    <div>
      <span>{{trajectory.label}}</span>
    </div>
    <div>
      <span>{{trajectory.parameters.phenomenon.label}}</span>
      <span *ngIf="trajectory.uom">[{{trajectory.uom}}]</span>
    </div>
  </div>
  <div class="combi-body">
    <div class="map-container">
      <n52-geometry-map-viewer class="map" mapId="trajectory" [geometry]="geometry" [maxMapZoom]="14" [highlight]="highlightGeometry" [zoomTo]="zoomToGeometry"></n52-geometry-map-viewer>
      <div class="mapNotifier" *ngIf="loading">
        <div>
          <div class="glyphicon glyphicon-refresh icon-spin"></div>
          <div translate="trajectories.map.loading"></div>
        </div>
      </div>
      <div class="map-options">
        <!-- <swc-mobile-map-path-toggler></swc-mobile-map-path-toggler> -->
      </div>
    </div>
    <div class="chart-container">
      <div class="chart">
        <n52-d3-timeseries-graph [datasetIds]="datasetIds" [timeInterval]="timespan" [datasetOptions]="options" [graphOptions]="graphOptions"
          [selection]="selection" (onSelectionChanged)="onChartSelectionChanged($event)" (onSelectionChangedFinished)="onChartSelectionChangedFinished($event)" (onHoverHighlight)="onChartHighlightChanged($event)"></n52-d3-timeseries-graph>
        <div class="chart-information">
          <span class="fa fa-info-circle" title="Der Betrachtungsraum lässt sich mit der Maus durch klicken und ziehen verkleiner. Mit einem einfach Klick auf das Diagramm wird wieder der ganze Betrachtungsraum dargestellt."></span>
        </div>
      </div>
      <div class="legend">
        <n52-multi-phenomenon-list [dataset]="trajectory" [datasetIds]="datasetIds" [datasetOptions]="options" (onAddDataset)="onAddDataset($event)"
          (onRemoveDataset)="onRemoveDataset($event)"></n52-multi-phenomenon-list>
      </div>
      <div class="chart-buttons">
        <div class="chart-control">
          <n52-string-toggler [value]="graphOptions.axisType" [option]="axisTypeDistance" icon="road" tooltip="X-Achse bildet die Distanz ab"
            (onToggled)="onAxisTypeChanged($event)"></n52-string-toggler>
        </div>
        <div class="chart-control">
          <n52-string-toggler [value]="graphOptions.axisType" [option]="axisTypeTime" icon="clock-o" tooltip="X-Achse bildet den Zeitraum ab"
            (onToggled)="onAxisTypeChanged($event)"></n52-string-toggler>
        </div>
        <div class="chart-control">
          <n52-string-toggler [value]="graphOptions.axisType" [option]="axisTypeTicks" icon="ellipsis-h" tooltip="X-Achse bildet die Messpunkte linear ab"
            (onToggled)="onAxisTypeChanged($event)"></n52-string-toggler>
        </div>
        <hr>
        <div class="chart-control">
          <n52-bool-toggler [value]="graphOptions.dotted" icon="line-chart" tooltip="Zeitreihe als Linien-/Punktdarstellung" (onToggled)="onDottedChanged($event)"></n52-bool-toggler>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="datasetIds.length === 0" class="container n52-alert">
  <div class="alert alert-primary" role="alert">
    <span>Bitte
      <a routerLink="/trajectories/selection" class="alert-link">wählen</a> Sie zuerst eine Trajektorie aus.</span>
  </div>
</div>